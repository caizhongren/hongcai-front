<!--login-->
<div class="register-bgimg new-hg">
  <div class="col-md-5 col-md-offset-6 bg-main-right">
    <div class="col-xs-6 text-center btn-register" ui-sref="root.login">登录</div>
    <div class="col-xs-6 text-center btn-register2" ui-sref="root.register">注册</div>
    <div class="row">
      <form class="form-login col-md-12 col-lg-12" role="form" name="registerForm" ng-submit="submitRegisterMobile(user);">
        <div class="form-group2 col-md-12 col-lg-12 margin-b-10">
          <div class="col-md-3 col-lg-3">
            <label for="mobile">手机号码</label>
          </div>
          <div class="col-md-8 col-lg-8">
            <input type="text" id="mobile" placeholder="请输入手机号码" name="mobile" ng-model="user.mobile" ng-pattern="/^((13[0-9])|(15[^4,\D])|(18[0-9])|(17[0678])|(14[0-9]))\d{8}$/" ensure-unique-mobile="mobile" ng-class="{'borderred':registerForm.mobile.$dirty && registerForm.mobile.$invalid && !registerForm.mobile.$focused,'borderwhite':!registerForm.mobile.$dirty || !registerForm.mobile.$invalid || registerForm.mobile.$focused}" required ng-focus />
          </div>
        </div>
        <div ng-if="registerForm.mobile.$dirty && registerForm.mobile.$invalid && !registerForm.mobile.$focused" class="col-lg-9 col-md-9 col-md-offset-3 col-lg-offset-3">
          <div ng-if="registerForm.mobile.$error.unique" class="row">
            <p class="input-tips regist-input-tips">手机号码已被占用</p>
          </div>
          <div ng-if="registerForm.mobile.$error.pattern" class="row">
            <p class="input-tips regist-input-tips">手机号码格式不正确</p>
          </div>
        </div>
        <div class="form-group2 col-md-12 col-lg-12 margin-t-10 margin-b-10">
          <div class="col-md-3 col-lg-3">
            <label for="account">密码</label>
          </div>
          <div class="col-md-8 col-lg-8">
            <input type="password" placeholder="请输入密码" id="password" name="password" ng-model="user.password" ng-minlength="6" ng-maxlength="22" ng-pattern="/^[\@A-Za-z0-9\!\#\$\%\^\&\*\.\~]{6,22}$/" ng-class="{'borderred':registerForm.password.$dirty && registerForm.password.$invalid && !registerForm.password.$focused,'borderwhite':!registerForm.password.$dirty || !registerForm.password.$invalid || registerForm.password.$focused}" required ng-focus />
          </div>
        </div>
        <div ng-if="registerForm.password.$dirty && registerForm.password.$invalid && !registerForm.password.$focused" class="col-lg-9 col-md-9 col-md-offset-3 col-lg-offset-3">
          <div ng-if="registerForm.password.$error.minlength" class="row">
            <p class="input-tips regist-input-tips">不能小于6个字符</p>
          </div>
          <div ng-if="registerForm.password.$error.maxlength" class="row">
            <p class="input-tips regist-input-tips">不能大于22个字符</p>
          </div>
          <div ng-if="registerForm.password.$error.pattern" class="row">
            <p class="input-tips regist-input-tips">长度6-22，数字或字母的组合，可以包含特殊字符</p>
          </div>
        </div>
        <div class="form-group2 col-md-12 col-lg-12 margin-t-10 margin-b-10" id="showCaptcha">
          <div class="col-md-3 col-lg-3">
            <label for="account">验证码</label>
          </div>
          <div class="col-md-8 col-lg-8 position-re">
            <input type="text" placeholder="请输入图片验证码" id="captcha" name="captcha" ng-model="user.picCaptcha" ensure-captcha="captcha" ng-class="{'borderred':registerForm.captcha.$dirty && registerForm.captcha.$invalid && registerForm.captcha.$error.check && !registerForm.captcha.$focused,'borderwhite':!registerForm.captcha.$dirty || !registerForm.captcha.$invalid || !registerForm.captcha.$error.check || registerForm.captcha.$focused}" required ng-focus />
          </div>
          <div class="captchaimg-tip" id="imgCaptcha" style="display:none;">
            <span class="left-arrow"></span>
            <img src="{{getPicCaptcha}}" id="checkCaptcha" class="pic-verify no-padding" ng-click="refreshCode()" width="80" height="70">
            <p ng-click="refreshCode()">点击图片刷新验证码</p>
          </div>
        </div>
        <div ng-if="registerForm.captcha.$dirty && registerForm.captcha.$invalid && registerForm.captcha.$error.check && !registerForm.captcha.$focused" class="col-lg-9 col-md-9 col-md-offset-3 col-lg-offset-3 form-div">
          <div class="row" ng-show="showPicCaptchaError">
            <p class="input-tips regist-input-tips">验证码错误</p>
          </div>
        </div>
        <div class="form-group3 col-md-12 col-lg-12 margin-t-10 margin-b-10">
          <div class="col-md-3 col-lg-3">
            <label for="account">短信验证</label>
          </div>
          <div class="col-md-8 col-lg-8">
            <input type="text" placeholder="请输入短信验证码" id="mobileCaptcha" check-mobile-captcha="mobileCaptcha" name="mobileCaptcha" ng-model="user.mobileCaptcha" ng-class="{'borderred':registerForm.mobileCaptcha.$dirty && registerForm.mobileCaptcha.$invalid && registerForm.mobileCaptcha.$error.check && !registerForm.mobileCaptcha.$focused}" required ng-focus />
            <button onclick="countDown(this,60,'out');" ng-click="sendMobileCaptcha(user);" ng-disabled="registerForm.mobile.$invalid || registerForm.captcha.$error.required">获取验证码</button>
          </div>
        </div>
        <div ng-if="registerForm.mobileCaptcha.$dirty && registerForm.mobileCaptcha.$invalid && registerForm.mobileCaptcha.$error.check && !registerForm.mobileCaptcha.$focused" class="col-lg-9 col-md-9 col-md-offset-3 col-lg-offset-3  form-div">
          <div class="row">
            <p class="input-tips regist-input-tips">验证码错误</p>
          </div>
        </div>
        <div class="form-group2 col-md-12 col-lg-12 margin-t-10">
          <div class="col-md-3 col-lg-3">
            <label for="account">邀请码</label>
          </div>
          <div class="col-md-8 col-lg-8">
            <input type="text" placeholder="请输入邀请码（选填）" ng-model="user.inviteCode" check-invite-code='inviteCode' name='inviteCode' id='inviteCode' />
          </div>
        </div>
        <div class="col-lg-9 col-md-9 col-md-offset-3 col-lg-offset-3 form-div" ng-if='registerForm.inviteCode.$error.isInviteCodeTrue'>
          <div class="row">
            <p class="input-tips regist-input-tips" style="margin-top:-12px;">邀请码无效</p>
          </div>
        </div>
        <div class="form-group col-md-12 col-lg-12">
          <label class="col-md-3 col-lg-3"></label>
          <div class="col-md-8 col-lg-8">
            <div class="row">
              <input type="checkbox" class="p-checkbox" ng-model="rememberUserName" ng-init="rememberUserName = true" />
              <p class="p-remember">同意《注册协议》</p>
            </div>
          </div>
          <br>
          <button type="submit" class="col-md-8 col-lg-8 margin-t-10 col-md-offset-3 btn btn-primary-orange {{registerForm.$invalid ? 'grey' : ''}} {{user.checkFlag == false ? 'grey' : ''}}" ng-disabled="registerForm.$invalid || user.checkFlag == false" ng-click="openTrusteeshipAccount=true">立即注册</button>
        </div>
      </form>
    </div>
  </div>
</div>
<div class="container-fluid bg-white-l footer-down margin-t-40">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 icons">
        <p class="text-center" style="color:#666666;">&copy; 2014-2015 宏财 All rights reserved &nbsp;&nbsp; 北京竞财投资服务有限公司 &nbsp;&nbsp; 京ICP备15025477号-1</p>
      </div>
      <div class="row col-xs-3 col-xs-offset-4">
        <table width="135" border="0" cellpadding="2" cellspacing="0" title="Click to Verify - This site chose Symantec SSL for secure e-commerce and confidential communications.">
          <tr>
            <td width="135" align="center" valign="top">
              <script type="text/javascript" src="https://seal.websecurity.norton.com/getseal?host_name=www.hongcai.com&amp;size=L&amp;use_flash=NO&amp;use_transparent=NO&amp;lang=zh_cn"></script>
              <a href="https://trustsealinfo.verisign.com/splash?form_file=fdf/splash.fdf&dn=www.hongcai.com&lang=zh_cn" target="_blank" style="color:#000000; text-decoration:none; font:bold 7px verdana,sans-serif; letter-spacing:.5px; text-align:center; margin:0px; padding:0px;" rel="nofollow"><img src="images/main/footer-icons.png">
              </a>
            </td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
<script>
$(document).ready(function() {
  $("#captcha").focus(function() {
    $("#imgCaptcha").css("display", "block");
  });
  $("#showCaptcha").mouseover(function() {
    $("#imgCaptcha").css("display", "block");
  }).mouseout(function() {
    $("#imgCaptcha").css("display", "none");
  });
});

function countDown(obj, second, inOrOut) {
  var getMobile = document.getElementById("mobile");
  var mobilePattern = /^((13[0-9])|(15[^4,\D])|(18[0-9])|(17[0678])|(14[0-9]))\d{8}$/;

  if (inOrOut === 'out' && window.buttonFlag == 0) {
    return;
  }

  // 如果秒数还是大于0，则表示倒计时还没结束
  if (mobilePattern.test(getMobile.value)) {
    if (second >= 0) {
      // 获取默认按钮上的文字

      if (typeof buttonDefaultValue === 'undefined') {
        buttonDefaultValue = obj.defaultValue;
      }
      // 按钮置为不可点击状态
      obj.disabled = true;
      window.buttonFlag = 0;
      // 按钮里的内容呈现倒计时状态
      //obj.value = buttonDefaultValue + '(' + second + ')';
      obj.innerHTML = "重新发送" + "(" + second + ")";
      // 时间减一
      second--;
      // 一秒后重复执行
      setTimeout(function() {
        countDown(obj, second, 'in');
      }, 1000);
      // 否则，按钮重置为初始状态
    } else {
      // 按钮置为可点击状态
      obj.disabled = false;
      window.buttonFlag = 1;
      // 按钮里的内容恢复初始状态
      obj.innerHTML = "发送验证码";
    }
  } else {
    obj.disabled = true;
    window.buttonFlag = 0;
  }
}
</script>
