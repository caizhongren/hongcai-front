<div id="project-detail" class="container">
  <div class="row">
      <div class="col-xs-12 col-md-8">
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default">
              <div class="panel-body">
                <div class="row">
                  <div class="hidden-xs hidden-md col-lg-5">
                    <img ng-src="{{project.image}}" alt="" ph-img="240x240" class="img-rounded">
                  </div> <!-- .hidden-xs.col-sm-4 -->
                  <div class="col-lg-7">
                    <div class="row">
                      <div class="col-xs-12">
                        <h1 class="project-name">{{ project.name || '项目名称'}}</h1>
                      </div>
                    </div> <!-- .row -->
                    <div class="row">
                      <div class="col-xs-12 col-sm-4 border-r">
                        <h3 class="text-center text-nowrap hc-text-red">{{project.annualEarnings || 0 | number : 2}}%</h3>
                        <h4 class="text-center text-nowrap">年化收益</h4>
                      </div> <!-- .col-xs-12.col-sm-4 -->
                      <div class="col-xs-12 col-sm-4 border-r">
                        <h3 class="text-center text-nowrap">{{project.total/10000 || 0}}万</h3>
                        <h4 class="text-center text-nowrap">项目规模</h4>
                      </div> <!-- .col-xs-12.col-sm-4 -->
                      <div class="col-xs-12 col-sm-4">
                        <h3 class="text-center text-nowrap">{{project.cycle || 0}}个月</h3>
                        <h4 class="text-center text-nowrap">项目期限</h4>
                      </div> <!-- .col-xs-12.col-sm-4 -->
                    </div> <!-- .row -->
                    <div class="row">
                      <div class="col-xs-12">
                        发布日期：{{ project.publishTime || 0 | amDateFormat: 'YYYY年MM月DD日'}}
                      </div>
                    </div> <!-- .row -->
                    <hr style="margin-top: 9px;margin-bottom: 9px;">
                    <!-- <div class="col-xs-12">&nbsp;</div> -->
                    <div class="row">
                      <div class="col-xs-12">
                        保荐机构：<a ui-sref="root.project-sponsorInstitution({guaranteeId: project.guaranteeId})" target="_blank">{{project.guaranteeName}}</a>
                      </div>
                      <div class="col-xs-12">
                        还款方式：{{project.repaymentName}}
                      </div>
                    </div> <!-- .row -->
                  </div> <!-- .col-sm-8 -->

                </div> <!-- .row -->
              </div> <!-- .panel-body -->
            </div> <!-- .panel.panel-default -->
          </div> <!-- .col-xs-12 -->
        </div> <!-- .row -->
        <div class="row">
          <div class="hidden-xs col-sm-12">&nbsp;</div>
        </div>
        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default project-info" ng-init="activeTab=0;">
              <ul class="nav nav-pills nav-justified">
                <li ng-class="{active: activeTab===$index}" ng-repeat="tab in tabs"><a ng-click="switchTab($index)">{{tab.title}}</a></li>
                <!-- <li ng-class="{active: activeTab===2}"><a ng-click="activeTab=2;">activeTab: {{activeTab}}</a></li>
                <li ng-class="{active: activeTab===3}"><a ng-click="activeTab=3;">activeTab: {{activeTab}}</a></li> -->
              </ul>
              <div class="tab-content">
                <div class="tab-pane" ng-class="{active: activeTab===$index}" ng-repeat="tab in tabs">
                  <section ng-if="tab.title==='项目信息'">
                    <div class="container-fluid">
                      <div class="row">
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 项目简介</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{projectInfo.description}}</p>
                        </div>
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 资金用途</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{projectInfo.financingPurpose}}</p>
                        </div>
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 还款来源</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{projectInfo.repaymentSource}}</p>
                        </div>
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 项目评估</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{projectInfo.riskManagementInfo}}</p>
                        </div>
                      </div>
                    </div>
                  </section> <!-- section -->
                  <section ng-if="tab.title==='企业信息'">
                    <div class="container-fluid">
                      <div class="row">
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 企业背景</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{enterprise.background}}</p>
                        </div>
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 营业范围</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{enterprise.businessScope}}</p>
                        </div>
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 经营状况</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{enterprise.businessState}}</p>
                        </div>
                      </div>
                    </div>
                  </section> <!-- section -->
                  <section ng-if="tab.title==='风控信息'">
                    <div class="container-fluid">
                      <div class="row">
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i>保荐机构</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{projectInfo.guaranteeSuggestion}}</p>
                        </div>
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i>风控措施</h4>
                        </div>
                        <div class="col-xs-12">
                          <p>{{projectInfo.riskManagementInfo}}</p>
                        </div>
                      </div>
                    </div>
                  </section> <!-- section -->
                  <section ng-if="tab.title==='相关文件'">
                    <div class="container-fluid">
                      <div class="row">
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 合同协议</h4>
                        </div>
                        <div class="col-xs-6 col-sm-4 file-padding" ng-repeat="contract in contractThumbnailFileList">
                          <div class="thumbnail">
                            <a class="grouped_elements" rel="group1" href="{{contractOriginalFileList[$index].uploadFile.url}}"><img fancybox width="175" height="125" hc-preview-url="{{enterPrise.uploadFile.url}}" ng-src="{{contract.uploadFile.url}}"></a>
                            <div class="caption">
                              <h5 class="file-head">{{contract.uploadFile.originalName}}</h5>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="row">
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 企业相关照片</h4>
                        </div>
                        <div class="row">
                          <div class="col-xs-6 col-sm-4 col-md-4 col-lg-4 file-padding" ng-repeat="enterPrise in enterpriseThumbnailFileList">
                            <div class="thumbnail">
                               <a class="grouped_elements" rel="group1" href="{{enterpriseOriginalFileList[$index].uploadFile.url}}"><img fancybox  width="175" height="125" hc-preview-url="{{enterPrise.uploadFile.url}}" ng-src="{{enterPrise.uploadFile.url}}"></a>
                              <div class="caption">
                                <h5 class="file-head">{{enterPrise.uploadFile.originalName}}</h5>
                              </div>
                            </div>
                          </div>
                        </div>

                      </div>
                    </div>
                  </section> <!-- section -->
                  <section ng-if="tab.title==='项目历程'">
                    <div class="container-fluid">
                      <div class="row">
                        <div class="col-xs-12">
                          <h4 class="page-header"><i class="fa fa-square hc-text-red"></i> 项目历程</h4>
                          <ul class="timeline">
                            <li>
                              <div class="timeline-badge primary"><i class="fa fa-rocket"></i></div>
                              <div class="timeline-panel">
                                <div class="timeline-heading">
                                  <h4 class="timeline-title">项目上线</h4>
                                </div>
                                <div class="timeline-body">
                                  <p>上线时间：{{project.publishTime}}</p>
                                </div>
                              </div>
                            </li>
                            <li class="timeline-inverted">
                              <div class="timeline-badge info"><i class="fa fa-users"></i></div>
                              <div class="timeline-panel">
                                <div class="timeline-heading">
                                  <h4 class="timeline-title">项目募集</h4>
                                </div>
                                <div class="timeline-body">
                                  <p>开始时间：{{project.releaseStartTime}}</p>
                                  <p>结束时间：{{project.releaseEndTime}}</p>
                                </div>
                              </div>
                            </li>
                            <li>
                              <div class="timeline-badge warning"><i class="fa fa-tree"></i></div>
                              <div class="timeline-panel">
                                <div class="timeline-heading">
                                  <h4 class="timeline-title">项目放款</h4>
                                </div>
                                <div class="timeline-body">
                                  <p>已还：{{projectInfo.projectBackTotal - (remainPrincipal + remainInterest)}}（{{billCount}}期）</p>
                                </div>
                              </div>
                            </li>
                            <li class="timeline-inverted">
                              <div class="timeline-badge success"><i class="fa fa-list-ol"></i></div>
                              <div class="timeline-panel">
                                <div class="timeline-heading">
                                  <h4 class="timeline-title">项目还款</h4>
                                </div>
                                <div class="timeline-body">
                                  <p>待还款：{{remainPrincipal + remainInterest}}（{{project.cycle - billCount}}期）</p>
                                </div>
                              </div>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </section> <!-- section -->
                </div>
              </div> <!-- .tab-content -->
            </div> <!-- .panel -->
          </div> <!-- .col-xs-12 -->
        </div> <!-- .row -->
      </div> <!-- .col-xs-12.col-md-8 -->
      <div class="col-xs-12 col-md-4">
        <div class="row">
          <div class="col-xs-12">
            <div class="form-horizontal">
              <div class="panel panel-default status">
                <div class="panel-heading ft-16 padding-tAb">
                  <strong>投资状态</strong>
                </div>
                <div class="panel-body">
                  <div class="row">
                    <div class="col-xs-12">
                      可投金额：{{project.currentStock * project.increaseAmount  | number : 0}}元
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-xs-12">
                      <span class="pull-left">投资进度：</span>
                      <div class="progress">
                        <div class="progress-bar progress-bar-info hc-bg-red" role="progressbar" aria-valuenow="{{project.progress || 0}}" aria-valuemin="0" aria-valuemax="100" style="width: {{project.progress||0}}%;">{{project.progress || 0 | number : 2}}%</div>
                      </div> <!-- .progress -->

                    </div>
                  </div>

                  <div class="col-xs-12 padding-0" ng-if="!isLogged">
                    <div class="row padding-t-0" ng-if="project.status == 6">
                      <div class="col-xs-12 padding-l-0">开放投资倒计时：</div>
                      <div class="col-xs-12 project-timer">
                        <timer end-time="statDate" finish-callback="finished()"><span>{{days}} 天,</span> <span>{{hours}} 小时,</span><span>{{minutes}} 分,</span> <span>{{seconds}} 秒</span></timer>
                      </div>
                    </div>

                    <a ui-sref="root.login({isRedirect: true})" class="btn btn-danger btn-lg btn-block">请先登录</a>

                    <!-- <button class="btn btn-lg btn-danger" data-template="views/modal/alert-unfinishedOrder.html" data-placement="top" data-duration="3" data-animation="am-fade-and-slide-top" data-container="body" data-keyboard="true" bs-alert="alert">Custom alert
                      <br>
                      <small>(using data-template)</small>
                    </button> -->



                  </div>

                  <div class="col-xs-12 padding-0" ng-if="isLogged && project.progress >= 100">
                    <input type='button'  value="已满标" class="btn btn-danger btn-lg btn-block" disabled="disabled"/>
                  </div>

                  <div class="row padding-t-0" ng-if="isLogged && project.progress < 100 && project.status != 6">
                    <div class="col-xs-12" ng-if="securityStatus.realNameAuthStatus + securityStatus.mobileStatus + securityStatus.emailStatus < 3">
                      <a ui-sref="root.userCenter.security-settings" class="btn btn-danger btn-lg btn-block">请完善资料</a>
                    </div>
                    <div class="col-xs-12" ng-if="securityStatus.realNameAuthStatus + securityStatus.mobileStatus + securityStatus.emailStatus == 3">
                      <div ng-switch on="isAvailable">
                        <div class="col-xs-12" ng-switch-when="1">
                          <!-- 有未完成的订单时展示 -->
                          <button class="btn btn-lg btn-danger btn-block"  data-animation="am-fade-and-slide-top" data-template="views/modal/alert-unfinishedOrder.html" data-placement="top" data-container="body" data-duration="1000" bs-alert="alert">立即投资
                        </div>
                        <form ng-submit="isAvailableInvest(project);" ng-switch-default>

                          <input type="number" min="0" max="1000000" step="100" name="project.amount" ng-model="project.amount" class="form-control margin-b-0" placeholder="投资金额（元）" required ng-switch-default>
                          <input type="hidden" name="project.id" ng-model="project.id" value="{{project.id}}">
                          <button class="btn btn-danger btn-lg btn-block" ng-switch-default>立即投资</button>

                        </form>
                      </div>
                    </div>
                  </div>
                  <div class="row padding-t-0" ng-if="isLogged && project.status == 6">
                    <div class="col-xs-12">开放投资倒计时：</div>
                    <div class="col-xs-12 project-timer">
                      <timer end-time="statDate" finish-callback="finished()"><span>{{days}} 天,</span> <span>{{hours}} 小时,</span><span>{{minutes}} 分,</span> <span>{{seconds}} 秒</span></timer>
                    </div>
                  </div>
                  <div class="col-xs-12" ng-if="isLogged && project.status == 6">
                    <a href="javascript:;" class="btn btn-default btn-lg btn-block">即将开始</a>
                  </div>
                  <!-- <div class="row">
                    <div class="col-xs-12">
                      <a href="" class="btn btn-danger btn-lg btn-block">立即投资</a>
                    </div>
                  </div> -->

                </div> <!-- .panel-body -->
              </div> <!-- .panel.panel-default -->
            </div>
          </div> <!-- .col-xs-12 -->
        </div> <!-- .row -->

        <div class="row">
          <div class="col-xs-12">
            <div class="panel panel-default" ng-init="activeTab_right=0;">
              <!-- <div class="panel-heading ft-16 padding-tAb"> -->
                <!-- <strong>投资记录</strong> -->
              <ul class="nav nav-pills nav-justified border-b">
                <li ng-class="{active: activeTab_right===$index}" ng-repeat="tab_right in tabs_right"><a ng-click="switchTab_right($index)">{{tab_right.title}}</a></li>

              </ul>
              <!-- </div> -->
              <div class="tab-content">
                <div class="tab-pane" ng-class="{active: activeTab_right===$index}" ng-repeat="tab_right in tabs_right">
                  <section ng-if="tab_right.title==='投资记录'">
                    <div class="panel-body">
                      <table class="table table-hover">
                        <thead>
                          <tr>
                            <th>成交时间</th>
                            <th>投资人</th>
                            <th>投标金额</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr  ng-repeat="order in orderList">
                            <td>{{order.createTime * 1000 | date: "yy-MM-dd"}}</td>
                            <td>{{order.userName}}</td>
                            <td>{{order.orderAmount| number : 0}}元</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </section>
                  <section ng-if="tab_right.title==='还款计划'">
                    <div class="panel-body">
                      <table class="table table-hover">
                        <thead>
                          <tr>
                            <th>预期还款时间</th>
                            <th>类型</th>
                            <th>还款金额</th>
                          </tr>
                        </thead>
                        <tbody>
                          <tr  ng-repeat="preRepayment in preRepaymentList">
                            <td>{{preRepayment.repaymentTime * 1000 | date: "yy-MM-dd"}}</td>
                            <td ng-if="preRepayment.type==1">利息</td>
                            <td ng-if="preRepayment.type==2">本金</td>
                            <td ng-if="preRepayment.type==3">本金+利息</td>
                            <td>{{preRepayment.repaymentAmount| number : 0}}元</td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </section>
                </div>
              </div>

            </div>
          </div>
        </div> <!-- .row -->
      </div> <!-- .col-xs-12.col-md-5 -->
    </div>
</div>
