<!--安全设置-->
<div class="right-area col-md-8 col-lg-9">
  <div class="row">
    <div class="right-title">安全设置</div>
  </div>
  <div class="row" style="padding-bottom:5%;" ng-hide="mobile && email && haveTrusteeshipAccount">
    <p class="ft-12 text-alg-c">
      *温馨提示*
      <br>为了您的投资安全，请您务必完成：<span ng-class="{'hc-text-red':!mobile}">手机号码绑定</span>，<span ng-class="{'hc-text-red':!email}">邮箱绑定</span>，和<span ng-class="{'hc-text-red':!haveTrusteeshipAccount}">开通第三方托管账户</span>。
    </p>
  </div>
  <div class="row">
    <div class="safe-process col-md-10 col-lg-10 col-md-offset-1 col-lg-offset-1">
      <div class="row">
        <p class="process-tips red-safe-pwd col-md-3 col-lg-3">登录密码</p>
        <p class="process-tips grey-safe-phone col-md-3 col-lg-3 {{ mobile != null ? 'red-safe-phone' : ''}}">手机号认证</p>
        <p class="process-tips grey-safe-mail col-md-3 col-lg-3 {{ email != null ? 'red-safe-mail' : ''}}">邮箱绑定</p>
        <p class="process-tips grey-safe-realname col-md-3 col-lg-3 {{ haveTrusteeshipAccount != false ? 'red-safe-realname' : ''}}">开通三方
          <br>托管账户</p>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="safe-part col-md-12 col-lg-12">
      <div class="row">
        <p class="tips col-md-4 col-lg-4">用户名</p>
        <p class="message col-md-4 col-lg-4">{{ loginName || "游客"}}</p>
        <div class="col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1">
          <p class="activity hadset">{{"已确定"}}</p>
          <div class="check-ok"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="safe-part col-md-12 col-lg-12">
      <div class="row">
        <p class="tips col-md-4 col-lg-4">登录密码</p>
        <p class="message col-md-4 col-lg-4">已设置</p>
        <p class="activity col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1" ng-click="changPwd = !changPwd;changeEmail=false;changeMobile=false">修改</p>
      </div>
    </div>
  </div>
  <div class="change-area change-pwd-height" ng-show="changPwd" ng-init="changPwd=false">
    <form class="real-name row" name="changePwdForm" ng-submit="changePassword(password)">
      <div class="col-md-8 col-lg-6 col-md-offset-2 col-lg-offset-3">
        <div class="row safe-form-group">
          <label for="oldPwd" class="col-md-4 col-lg-4">原始密码：</label>
          <input type="password" class="verify-input col-md-6 col-lg-6" name="oldPwd" id="oldPwd" ng-model="password.oldPassword" check-password="oldPwd" required ng-focus autofocus/>
          <div class="user-tips-area safe-tips-area" ng-show="changePwdForm.oldPwd.$dirty && changePwdForm.oldPwd.$invalid && !changePwdForm.oldPwd.$focused && changePwdForm.oldPwd.$error.required">
            <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
          </div>
          <div class="user-tips-area safe-tips-area" ng-show="changePwdForm.oldPwd.$dirty && !changePwdForm.oldPwd.$focused && changePwdForm.oldPwd.$error.isPasswordTrue && !changePwdForm.oldPwd.$error.required">
            <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>密码错误</p>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-4">新密码：</label>
          <input type="password" class="verify-input col-md-6 col-lg-6" name="newPwd" id="newPwd" ng-model="password.newPassword" ng-focus required/>
          <div class="user-tips-area safe-tips-area" ng-show="changePwdForm.newPwd.$dirty && changePwdForm.newPwd.$invalid && !changePwdForm.newPwd.$focused">
            <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-4">确认密码：</label>
          <input type="password" class="verify-input col-md-6 col-lg-6" name="confirmPwd" id="confirmPwd" ng-focus ng-model="password.repeatNewPassword" required/>
          <div class="user-tips-area safe-tips-area" ng-show="changePwdForm.confirmPwd.$dirty && changePwdForm.confirmPwd.$invalid && !changePwdForm.confirmPwd.$focused">
            <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
          </div>
          <div class="user-tips-area safe-tips-area" ng-show="changePwdForm.confirmPwd.$dirty && !checkTwoPassword(password) && !changePwdForm.confirmPwd.$focused && !changePwdForm.confirmPwd.$error.required">
            <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>密码不一致</p>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-4"></label>
          <input type="submit" value="确定" class="btn-primary-orange col-md-3 col-lg-3" ng-disabled="changePwdForm.$invalid" />
        </div>
      </div>
    </form>
  </div>
  <div class="row">
    <div class="safe-part col-xs-12">
      <div class="row">
        <p class="tips col-xs-4">手机号码</p>
        <p class="message col-xs-4">{{ mobile || "未设置"}}</p>
        <p class="activity col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1 hc-text-red" ng-show="!mobile" ng-click="changeMobile=!changeMobile;changeEmail=false;changPwd =false">设置</p>
        <!--      <p class="activity col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1" ng-click="resetMobile()" ng-show="mobile">修改</p> -->
        <div class="col-xs-3 col-xs-offset-1" ng-show="mobile">
          <p class="activity hadset">{{"已确定"}}</p>
          <div class="check-ok"></div>
        </div>
        <!-- <p class="activity col-xs-3 col-xs-offset-1" ng-show="mobile" ng-click="changeMobile=!changeMobile;changeEmail=false;changPwd =false">修改</p> -->
      </div>
    </div>
  </div>
  <div class="change-area change-phone-height" ng-show="changeMobile" ng-init="changeMobile=false">
    <form class="real-name row" name="changeMobileForm">
      <div class="col-xs-9 col-xs-offset-2">
        <div class="safe-form-group row">
          <label for="captcha" class="col-xs-3">图片验证码：</label>
          <input type="text" class="col-md-3 col-lg-3 borderwhite" id="captcha" name="captcha" ng-model="picCaptcha" ensure-captcha="captcha" ng-class="col-xs-offset-1 col-xs-2" required ng-focus />
          <img src="{{getPicCaptcha}}" id="checkCaptcha" class="pic-verify col-md-2 col-lg-2 no-padding" ng-click="refreshCode()">
          <div class="refresh-pic col-md-1 col-lg-1" ng-click="refreshCode()"></div>
        </div>
        <div class="safe-form-group row">
          <label class="col-xs-3">手机号码：</label>
          <input type="text" class="verify-input col-xs-3" id="mobileNo" name="mobileNo" ng-model="mobileNo" ng-pattern="/^((13[0-9])|(15[^4,\D])|(18[0-9])|(17[0678])|(14[0-9]))\d{8}$/" ensure-unique-mobile="mobileNo" ng-focus required autofocus/>
          <input type="button" value="获取验证码" class="col-xs-offset-1 col-xs-2 {{changeMobileForm.mobileNo.$invalid ? 'white-button verify-index grey' : 'white-button verify-index'}}" ng-click="sendMobileCaptcha(mobileNo, picCaptcha)" onclick="countDown(this,60);" id="getVerify" ng-disabled="changeMobileForm.mobileNo.$invalid" />
          <div ng-show="changeMobileForm.mobileNo.$dirty && changeMobileForm.mobileNo.$invalid && !changeMobileForm.mobileNo.$focused" class="col-xs-2">
            <div class="user-tips-area row" ng-show="changeMobileForm.mobileNo.$error.required &&
                    !changeMobileForm.mobileNo.$focused">
              <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
            </div>
            <div class="user-tips-area row" ng-show="changeMobileForm.mobileNo.$error.pattern &&
                      !changeMobileForm.mobileNo.$focused">
              <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>格式错误</p>
            </div>
            <div class="user-tips-area row" ng-show="changeMobileForm.mobileNo.$error.unique">
              <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>已被占用</p>
            </div>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-3 col-lg-3">短信验证码：</label>
          <input type="text" class="verify-input col-md-3 col-lg-3" name="inputCaptcha" ng-model="inputCaptcha" ng-focus required/>
          <div class="user-tips-area safe-tips-area" ng-show="changeMobileForm.inputCaptcha.$error.required &&changeMobileForm.inputCaptcha.$dirty">
            <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-3 col-lg-3"></label>
          <input type="submit" value="确定" class="btn-primary-orange col-md-2 col-lg-2" ng-click="bindMobile(mobileNo, inputCaptcha)" ng-disabled="changeMobileForm.$invalid" />
        </div>
      </div>
    </form>
  </div>
  <div class="row">
    <div class="safe-part col-md-12 col-lg-12">
      <div class="row">
        <p class="tips col-md-4 col-lg-4">邮箱</p>
        <p class="message col-md-4 col-lg-4">{{ email || "未设置"}}</p>
        <p class="activity col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1 hc-text-red" ng-show="!email" ng-click="changeEmail=!changeEmail;changPwd =false;changeMobile=false">设置</p>
        <p class="activity col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1" ng-show="email" ng-click="changeEmail=!changeEmail;changPwd =false;changeMobile=false">修改</p>
      </div>
    </div>
  </div>
  <div class="change-area change-mail-height" ng-show="changeEmail" ng-init="changeEmail = false">
    <form class="real-name row" name="bindEmailForm">
      <div class="col-md-8 col-lg-6 col-md-offset-2 col-lg-offset-">
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-5">邮箱：</label>
          <input type="text" class="verify-input col-md-6 col-lg-6" id="newEmail" name="newEmail" ng-model="newEmail" ng-pattern="/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/" ensure-unique-email="newEmail" required ng-focus autofocus/>
          <div ng-show="
              bindEmailForm.newEmail.$dirty &&
              bindEmailForm.newEmail.$invalid &&
              !bindEmailForm.newEmail.$focused">
            <div class="user-tips-area safe-tips-area safe-email-change" ng-show="bindEmailForm.newEmail.$error.pattern">
              <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>格式错误</p>
            </div>
            <div class="user-tips-area safe-tips-area safe-email-change" ng-show="bindEmailForm.newEmail.$error.unique">
              <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>已被占用</p>
            </div>
            <div class="user-tips-area safe-tips-area safe-email-change" ng-show="bindEmailForm.newEmail.$error.required">
              <p class="input-tips user-input-tips security-stl"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
            </div>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-5"></label>
          <input type="submit" value="确定" class="btn-primary-orange col-md-3 col-lg-3" ng-disabled="bindEmailForm.$invalid" ng-click="bindEmail(newEmail)" />
        </div>
      </div>
    </form>
  </div>
  <div class="row">
    <div class="safe-part col-md-12 col-lg-12">
      <div class="row">
        <p class="tips message col-md-4 col-lg-4">第三方托管账户</p>
        <p class="message col-md-4 col-lg-4" ng-show="!haveTrusteeshipAccount">未开通</p>
        <p class="message col-md-4 col-lg-4" ng-show="haveTrusteeshipAccount">已开通</p>
        <div class="col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1">
          <p class="activity" ng-show="!haveTrusteeshipAccount"><a href="javascript:;" class="hc-text-red" ng-click="openTrusteeshipAccount = !openTrusteeshipAccount;changeMobile=false;changeEmail=false;changPwd =false;checkEmailAndMobile()">开通</a>
          </p>
          <p class="activity hadset" ng-show="haveTrusteeshipAccount">已开通</p>
          <div class="check-ok" ng-show="haveTrusteeshipAccount"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="change-area change-phone-height" ng-show="openTrusteeshipAccount">
    <form class="real-name row" name="openTrusteeshipAccountForm">
      <div class="col-md-8 col-lg-6 col-md-offset-2 col-lg-offset-3">
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-4">真实姓名：</label>
          <input type="text" class="verify-input col-md-6 col-lg-6" name="realName" ng-model="user.realName" ng-focus required/>
          <div class="user-tips-area safe-tips-area" ng-show="openTrusteeshipAccountForm.realName.$dirty && openTrusteeshipAccountForm.realName.$error.required">
            <p class="input-tips user-input-tips"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-4">身份证号：</label>
          <input type="text" ng-maxlength="18" class="verify-input col-md-6 col-lg-6" name="idCardNo" ng-pattern="/^([0-9]{17}[0-9X]{1})|([0-9]{15})$/" ng-model="user.idCardNo" ng-focus required/>
          <div class="user-tips-area safe-tips-area" ng-show="openTrusteeshipAccountForm.idCardNo.$dirty && openTrusteeshipAccountForm.idCardNo.$error.required">
            <p class="input-tips user-input-tips"><i class="fa fa-times-circle-o login-check-img"></i>不能为空</p>
          </div>
        </div>
        <div class="safe-form-group row">
          <label class="col-md-4 col-lg-4"></label>
          <input type="submit" value="确定" class="btn-primary-orange col-md-3 col-lg-3" ng-disabled="openTrusteeshipAccountForm.$invalid" ng-click="realNameAuth(user)" />
        </div>
      </div>
    </form>
  </div>
  <div class="row">
    <div class="safe-part col-md-12 col-lg-12">
      <div class="row">
        <p class="tips message col-md-4 col-lg-4">开通自动投标权限</p>
        <p class="message col-md-4 col-lg-4" ng-show="!openTrustReservation">未开通</p>
        <p class="message col-md-4 col-lg-4" ng-show="openTrustReservation">已开通</p>
        <div class="col-md-3 col-lg-3 col-md-offset-1 col-lg-offset-1">
          <p class="activity" ng-show="!openTrustReservation"><a href="javascript:;" class="hc-text-red" ng-click="openReservation();">开通</a>
          </p>
          <p class="activity hadset" ng-show="openTrustReservation">已开通</p>
          <div class="check-ok" ng-show="openTrustReservation"></div>
        </div>
      </div>
    </div>
  </div>
</div>
<script>
function countDown(obj, second) {
  // 如果秒数还是大于0，则表示倒计时还没结束
  if (second >= 0) {
    // 获取默认按钮上的文字
    if (typeof buttonDefaultValue === 'undefined') {
      buttonDefaultValue = obj.defaultValue;
    }
    // 按钮置为不可点击状态
    obj.disabled = true;
    // 按钮里的内容呈现倒计时状态
    //obj.value = buttonDefaultValue + '(' + second + ')';
    obj.value = second + "s 后重新发送";
    obj.className = 'col-xs-offset-1 col-xs-2 white-button grey';
    // 时间减一
    second--;
    // 一秒后重复执行
    setTimeout(function() {
      countDown(obj, second);
    }, 1000);
    // 否则，按钮重置为初始状态
  } else {
    // 按钮置未可点击状态
    obj.disabled = false;
    // 按钮里的内容恢复初始状态
    obj.className = 'white-button';
    obj.value = buttonDefaultValue;
  }
}
</script>
