
<!--user-center-sidebar-->
<div class="left-area ft-14" ng-if="selectSide !=='questionnaire' ">
  <div class="overview">
    <div class="user-portrait" id="crop-avatar">
      <div class="portrait" ng-click="showAvaterModal = true">
        <img class="cursor-pointer" ng-src="{{loginUser.headImgUrl || headImgUrl}}" title="更换头像">
      </div>
      <p class="user-name ft-grey666 ft-18 text-center">{{ loginUser.nickName || (loginUser.mobile || loginName) }}~ </p>
      <p class="security-level ft-12 text-center" ng-if="securityStatus.trusteeshipAccountStatus + securityStatus.mobileStatus == 1">安全等级：低<a href="#" ui-sref="root.userCneter.security-settings">(如何提升)</a></p>
      <p class="security-level ft-12 text-center" ng-if="securityStatus.trusteeshipAccountStatus + securityStatus.mobileStatus == 2">安全等级：高</a></p>
    </div>
    <div class="flow-icons" ng-mouseleave="showTip1=false;showTip2=false;showTip3=false;showTip4=false;">
      <!-- ng-if="!haveTrusteeshipAccount && showTip2==true"-->
      <div class="icons position-re">
        <div class="sidebar-tip" ng-show="mobile !== undefined && showTip1==true" ng-mouseleave="showTip1=false">您已完成手机绑定：{{mobile}}&nbsp;&nbsp;<span class="cursor-pointer ft-blue" ui-sref="root.userCenter.security-settings" ng-click="resetMobile();">修改</span></div>
        <div class="position-re" ng-mouseenter="showTip1 = true;showTip2 = false;showTip3 = false;showTip4 = false;" ng-init="showTip1=false">
          <img src="/images/user-center/mobile.png">
          <i class="fa fa-check-circle ft-green position-ab" aria-hidden="true" ng-show="mobile !== undefined"></i>
        </div>
        <div class="sidebar-tip sidebar-tip2" ng-show="!haveTrusteeshipAccount && showTip2==true" ng-mouseleave="showTip2=false">您尚未开通资金存管系统&nbsp;&nbsp;<span class="cursor-pointer ft-blue" ng-click="openTrusteeshipAccount();">开通</span></div>
        <div class="sidebar-tip sidebar-tip2" ng-show="haveTrusteeshipAccount && showTip2==true" ng-mouseleave="showTip2=false">您已开通资金存管系统</div>
        <div class="position-re" ng-mouseenter="showTip2 = true;showTip1 = false;showTip3 = false;showTip4 = false;">
          <img src="/images/user-center/cgt.png">
          <i class="fa fa-check-circle ft-green position-ab i2" aria-hidden="true" ng-show="haveTrusteeshipAccount"></i>
        </div>
        <div class="sidebar-tip sidebar-tip3" ng-show="haveTrusteeshipAccount && showTip3==true" ng-mouseleave="showTip3=false">您已设置交易密码&nbsp;&nbsp;<span class="cursor-pointer ft-blue">修改</span></div>
        <div class="position-re" ng-mouseenter="showTip3 = true;showTip2 = false;showTip1 = false;showTip4 = false;">
          <img src="/images/user-center/password.png">
          <i class="fa fa-check-circle ft-green position-ab i3" aria-hidden="true" ng-show="haveTrusteeshipAccount"></i>
        </div>
        <div class="sidebar-tip sidebar-tip4" ng-show="!haveCard && !isVerifying && !unbinding && showTip4==true" ng-mouseleave="showTip4=false">您尚未邦定银行卡&nbsp;&nbsp;<span class="cursor-pointer ft-blue" ng-click="bindBankCard();">绑定</span></div>
        <div class="sidebar-tip sidebar-tip4" ng-show="haveCard && !isVerifying && !unbinding && showTip4==true" ng-mouseleave="showTip4=false">您已绑定银行卡&nbsp;&nbsp;<span class="cursor-pointer ft-blue" ui-sref="root.userCenter.bankcard-management">查看</span></div>
        <div class="position-re" ng-mouseenter="showTip4 = true;showTip2 = false;showTip3 = false;showTip1 = false;">
          <img src="/images/user-center/bankcard.png">
          <i class="fa fa-check-circle ft-green position-ab i4" aria-hidden="true" ng-show="isAuth && haveCard && !isVerifying && !unbinding"></i>
        </div>
      </div>
    </div>
  </div>
  <div class="sidebar-items">
    <div class="nav-items">
      <ul class="padding-t-15 padding-b-15">
        <li class="side-tab ft-16 ft-grey666"><span><img src="/images/user-center/account-info.png"></span>账户信息</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'account-overview' ? 'now' : ''}}" ui-sref="root.userCenter.account-overview">账户总览</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'security-settings' ? 'now' : ''}}" ui-sref="root.userCenter.security-settings">账户设置</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'bankcard-management' ? 'now' : ''}}" ui-sref="root.userCenter.bankcard-management">银行卡管理</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'message' ? 'now' : ''}}" ui-sref="root.userCenter.message({status:'0,1'})">站内信（{{unreadCount || 0}}）</li>
        <li class="side-tab ft-16 ft-grey666"><span><img src="/images/user-center/funds-info.png"></span>资金信息</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'record' ? 'now' : ''}}" ui-sref="root.userCenter.record">资金流水</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'recharge' ? 'now' : ''}}" ui-sref="root.userCenter.recharge">充值</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'withdraw' ? 'now' : ''}}" ui-sref="root.userCenter.withdraw">提现</li>
        <li class="side-tab ft-16 ft-grey666"><span><img src="/images/user-center/invest-info.png"></span>投资信息</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'credit' || selectPage_two == 'credit'? 'now' : ''}}" ui-sref="root.userCenter.credit">我的投资</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'assignments'  || selectPage_two == 'assignments'? 'now' : ''}}" ui-sref="root.userCenter.assignments">债权转让</li>
        <li class="ft-16 ft-grey666">自动投标</li>
        <li class="side-tab ft-16 ft-grey666"><span><img src="/images/user-center/award-info.png"></span>奖励信息</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'cash-coupon' ? 'now' : ''}}" ui-sref="root.userCenter.cash-coupon">奖金</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'rate-coupon' ? 'now' : ''}}" ui-sref="root.userCenter.rate-coupon">加息券</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'experience-money' ? 'now' : ''}}" ui-sref="root.userCenter.experienceMoney">体验金</li>
        <li class="ft-16 ft-grey666 {{selectSide == 'invite-rebate' ? 'now' : ''}}" ui-sref="root.userCenter.invite-rebate">邀请好友</li>
      </ul>
    </div>
  </div>
  <!-- 修改头像 -->
  <div class="modal" id="avatar-modal" aria-hidden="true" aria-labelledby="avatar-modal-label" role="dialog" tabindex="-1" ng-show="showAvaterModal">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <form class="avatar-form" enctype="multipart/form-data" method="post">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" ng-click="showAvaterModal = false;">&times;</button>
            <h4 class="modal-title" id="avatar-modal-label">修改头像</h4>
          </div>
          <div class="modal-body">
            <div class="avatar-body">

              <!-- Upload image and data -->
              <div class="avatar-upload">
                <input type="hidden" class="avatar-src" name="avatar_src">
                <input type="hidden" class="avatar-data" name="avatar_data">
                <label for="avatarInput">上传图片</label>
                <input type="file" class="avatar-input" accept="image/*,camera" id="avatarInput" name="avatar_file">
              </div>

              <!-- Crop and preview -->
              <div class="row">
                <div class="col-md-9">
                  <div class="avatar-wrapper" id="cropImg">
                    <img src="data:images/jpeg;base64,">
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="avatar-preview preview-lg">
                    <img src="/images/user-center/portrait.png">
                  </div>
                  <div class="avatar-preview preview-md">
                    <img src="/images/user-center/portrait.png">
                  </div>
                  <div class="avatar-preview preview-sm">
                    <img src="/images/user-center/portrait.png">
                  </div>
                </div>
              </div>

              <div class="row avatar-btns">
                <div class="col-md-3">
                  <button type="button" class="btn btn-primary btn-block avatar-save" ng-click="submit();">确定</button>
                </div>
              </div>
            </div>
          </div>
          <!-- <div class="modal-footer">
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div> -->
        </form>
      </div>
    </div>
  </div>
</div>
  
  <script type="text/javascript">
  
    var $image = $('#cropImg>img');
    var saveBtn = $('.avatar-btns>.avatar-save')
    //初始化
    $image.cropper({
      // viewMode: 1,
      aspectRadio: 16/9,
      preview:'.avatar-preview',
      crop: function(data) {
        console.log(data);
      }
    });
    var fileName; 
    //选择上传的文件名
    $('#avatarInput').change(function(){
        var file = this.files[0];
        fileName = file.name;
        var reader = new FileReader();
        //reader回调，重新初始裁剪区
        reader.onload = function(){
            // 通过 reader.result 来访问生成的 DataURL
            var url = reader.result;
            //选择图片后重新初始裁剪区
            $image.cropper('reset', true).cropper('replace', url);
        };
        reader.readAsDataURL(file);
    });
</script>